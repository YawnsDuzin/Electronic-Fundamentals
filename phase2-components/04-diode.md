# 04. 다이오드 (Diode)

## 목차
1. [다이오드란?](#1-다이오드란)
2. [다이오드의 역할](#2-다이오드의-역할)
3. [순방향 전압 강하](#3-순방향-전압-강하)
4. [역전류 방지 (역접속 보호)](#4-역전류-방지-역접속-보호)
5. [플라이백 다이오드](#5-플라이백-다이오드)
6. [자주 쓰는 다이오드](#6-자주-쓰는-다이오드)
7. [실습: ESP32 회로에서 다이오드 활용](#7-실습-esp32-회로에서-다이오드-활용)
8. [핵심 정리](#핵심-정리)

---

## 1. 다이오드란?

다이오드(Diode)는 **전류를 한 방향으로만 흐르게 하는** 반도체 소자입니다.
이전에 배운 LED도 다이오드의 한 종류입니다 (빛을 내는 다이오드).

```
소프트웨어 비유:
다이오드는 "단방향 파이프(One-way Pipe)" 또는
"읽기 전용 스트림(Read-only Stream)"과 같습니다.
데이터(전류)가 한 방향으로만 흐를 수 있습니다.

또는 if 문으로 표현하면:
if (voltage > threshold) {
    allow_current();    // 순방향: 전류 흐름
} else {
    block_current();    // 역방향: 전류 차단
}
```

### 기본 원리

```
순방향 (Forward Bias):           역방향 (Reverse Bias):

  A(+) ──▶── K(-)                A(+) ──◀── K(-)
  전류 흐름! (ON)                 전류 차단! (OFF)

  ──▶|──                         ──|◀──
  애노드  캐소드                   애노드  캐소드


회로도 기호:
                     전류 방향
                    ────────▶
    애노드(+)                     캐소드(-)
        │                            │
        ├────▶|──────────────────────┤
        │    ↑                       │
        │  삼각형                     │
        │  꼭지점 방향               │
        │  = 전류 방향               │
```

### 외형과 극성 확인

```
일반 다이오드 (축 방향 패키지):

    ┌──────────────────────┐
    │                 ▌    │ ← 띠(밴드) = 캐소드(-) 쪽
    │              밴드    │
    └──┬──────────────┬───┘
       │              │
    애노드(+)      캐소드(-)

    ※ 띠가 있는 쪽이 캐소드(-)!
    ※ 회로도의 세로 막대(|)와 같은 쪽!
```

---

## 2. 다이오드의 역할

### 2-1. 정류 (Rectification)

교류(AC)를 직류(DC)로 변환하는 가장 기본적인 용도입니다.

```
교류(AC) 입력:              반파 정류 후:

    ╱╲    ╱╲               ╱╲    ╱╲
   ╱  ╲  ╱  ╲             ╱  ╲  ╱  ╲
──╱────╲╱────╲──    ──▶|──╱────╲╱────╲──
        ╲  ╱                    (음의 반파 차단)
         ╲╱

음의 반파도 있음             양의 반파만 통과!
```

### 2-2. 역전류 방지 (Reverse Current Protection)

배터리나 전원을 거꾸로 연결해도 회로를 보호합니다.

```
    전원(+) ──▶|── 회로 ── 전원(-)
           보호 다이오드

    정상 연결: 다이오드 순방향 → 전류 흐름 → 정상 동작
    역 연결:  다이오드 역방향 → 전류 차단 → 회로 보호!
```

### 2-3. 전압 클램핑 (Voltage Clamping)

특정 전압 이상이 되지 않도록 제한합니다.

```
    신호 ──┬── 출력
           │
          ▶|── 3.3V (기준 전압)
           │
          ▶|── GND
           │
          GND

    신호가 3.3V + 0.7V = 4.0V 이상이면 다이오드가 도통
    → 전압을 4.0V로 제한 (ESP32 입력 보호)
```

### 2-4. OR 게이트 (Diode OR)

```
    전원1 ──▶|──┐
                ├── 출력 (둘 중 높은 전압)
    전원2 ──▶|──┘

    두 전원 중 하나라도 있으면 출력에 전압이 나옴
    (배터리 + USB 전원 자동 전환 등)
```

---

## 3. 순방향 전압 강하

다이오드에 전류가 흐르면, 다이오드 양단에 **일정한 전압 강하(Voltage Drop)**가 발생합니다.
이것을 **순방향 전압(Vf, Forward Voltage)**이라고 합니다.

### 다이오드 종류별 순방향 전압

| 다이오드 종류 | 순방향 전압 (Vf) | 특징 |
|:-------------|:---------------:|------|
| 실리콘 (Si) 다이오드 | **~0.7V** | 가장 일반적, 1N4007 등 |
| 쇼트키 (Schottky) 다이오드 | **~0.3V** | 낮은 Vf, 고속, 1N5819 등 |
| 게르마늄 (Ge) 다이오드 | ~0.3V | 거의 사용 안 함 (구식) |
| LED (발광 다이오드) | 1.8~3.4V | 색상에 따라 다름 |
| 제너 (Zener) 다이오드 | 역방향 사용 | 정전압 회로용 |

### 전압 강하의 영향

```
예: 5V 전원에 실리콘 다이오드(1N4007)를 보호용으로 연결

    5V ──▶|── 회로 ── GND
       Vf=0.7V

    회로에 실제로 걸리는 전압:
    5V - 0.7V = 4.3V

    ※ 0.7V가 "손실"됨!
    ※ ESP32는 최소 3.0V가 필요하므로, 5V에서는 괜찮지만
       3.3V 전원에 다이오드를 직렬로 넣으면 3.3V - 0.7V = 2.6V → 부족!

    해결: 쇼트키 다이오드(Vf ≈ 0.3V) 사용
    3.3V - 0.3V = 3.0V → 간신히 동작 (여유 없음)
```

### 온도에 따른 변화

```
실리콘 다이오드의 순방향 전압은 온도가 올라가면 약간 줄어듭니다:
약 -2mV/°C

25°C: Vf ≈ 0.7V
75°C: Vf ≈ 0.6V (50도 상승 × -2mV = -0.1V)

대부분의 경우 무시해도 됩니다.
```

---

## 4. 역전류 방지 (역접속 보호)

### 배터리 역접속 보호 회로

배터리를 거꾸로 넣어도 회로가 파손되지 않도록 보호합니다.

```
방법 1: 직렬 다이오드 (간단하지만 전압 손실 있음)

    배터리(+) ──▶|── VCC ── 회로 ── GND ── 배터리(-)
              1N5819
             (Vf≈0.3V)

    장점: 간단
    단점: 항상 0.3~0.7V 전압 손실


방법 2: P-채널 MOSFET (전압 손실 거의 없음, 고급)

    배터리(+) ──[P-MOSFET]── VCC ── 회로
                  │
               [다이오드]
                  │
                 GND

    장점: 전압 손실 매우 작음 (수십 mV)
    단점: 부품이 많고 복잡
```

### 외부 전원 역접속 보호

```
    DC 잭                ESP32 개발보드
    ┌────┐               ┌──────────┐
    │ +  ├──▶|──(Vf)───┤ VIN      │
    │    │   1N5819      │          │
    │ -  ├───────────────┤ GND      │
    └────┘               └──────────┘

    전원을 거꾸로 연결해도:
    - 다이오드가 역방향 → 전류 차단
    - ESP32 보호!
```

---

## 5. 플라이백 다이오드

### 역기전력(Back-EMF)이란?

모터, 릴레이, 솔레노이드 같은 **유도성 부하(코일이 있는 장치)**는
전원을 끌 때 **역기전력(Back-EMF)**이라는 높은 전압 스파이크를 발생시킵니다.

```
릴레이 코일 ON → OFF 순간:

    전압
     │
     │        ┌── 역기전력! (수십~수백 V)
     │       ╱│
  12V├──────╱ │
     │     │  │
   0V├─────┘  └───────────────
     └────────────────────────→ 시간
              ↑
         OFF 순간에
         큰 전압 스파이크 발생!

    이 스파이크가 트랜지스터나 ESP32를 파괴할 수 있습니다!
```

### 플라이백 다이오드의 역할

```
플라이백 다이오드 없이:          플라이백 다이오드 있을 때:

    ESP32                        ESP32
     │                            │
   [MOSFET]                    [MOSFET]
     │                            │
   ┌─┴──┐                      ┌─┴──┐
   │코일 │  ← 역기전력!         │코일 │──▶|── ← 다이오드가
   │    │     스파이크          │    │         역기전력을
   └─┬──┘     = 파손!          └─┬──┘         코일 안에서
     │                            │            순환시켜 흡수
    GND                          GND

    MOSFET 파손!                  MOSFET 안전!
```

### 플라이백 다이오드 연결 방법

```
핵심: 다이오드를 코일에 "역방향"으로 병렬 연결

    VCC (12V)
     │
     ├────────┐
     │        │
   ┌─┴──┐   ▶|  ← 플라이백 다이오드 (1N4007 또는 1N5819)
   │릴레이│   │     (코일의 전류 방향과 반대로!)
   │코일 │   │
   └─┬──┘   │
     │        │
     ├────────┘
     │
   [MOSFET Drain]
     │
   [MOSFET Source]
     │
    GND

    정상 동작 시: 다이오드 역방향 → 영향 없음
    OFF 순간:    역기전력이 다이오드를 통해 순환 → MOSFET 보호!
```

> **반드시 기억:** 릴레이, 모터, 솔레노이드를 트랜지스터/MOSFET으로 제어할 때는
> **반드시 플라이백 다이오드를 달아야 합니다!**

---

## 6. 자주 쓰는 다이오드

### 1N4007 - 범용 정류 다이오드

```
    ┌──────────────────────────┐
    │          1N4007          │
    │                     ▌   │ ← 밴드 = 캐소드(-)
    └──┬──────────────────┬───┘
       │                  │
    애노드(+)          캐소드(-)
```

| 사양 | 값 |
|------|-----|
| 최대 역전압 | 1000V |
| 최대 순방향 전류 | 1A |
| 순방향 전압 (Vf) | ~1.0V (1A 시), ~0.7V (소전류) |
| 역회복 시간 | ~30μs (느림) |
| 용도 | 역접속 보호, 정류, 플라이백 다이오드 |
| 가격 | 매우 저렴 (10원 이하) |

> **팁:** 1N4001~1N4007은 같은 시리즈. 숫자가 클수록 역전압이 높음.
> 1N4007(1000V)을 사면 모든 상황에서 사용 가능!

### 1N5819 - 쇼트키 다이오드

```
    ┌──────────────────────────┐
    │          1N5819          │
    │                     ▌   │ ← 밴드 = 캐소드(-)
    └──┬──────────────────┬───┘
       │                  │
    애노드(+)          캐소드(-)
```

| 사양 | 값 |
|------|-----|
| 최대 역전압 | 40V |
| 최대 순방향 전류 | 1A |
| 순방향 전압 (Vf) | **~0.3~0.5V** (실리콘보다 훨씬 낮음!) |
| 역회복 시간 | 매우 빠름 |
| 용도 | 전원 보호, 고속 정류, SMPS |
| 가격 | 저렴 (수십 원) |

> **쇼트키 vs 실리콘:** 쇼트키는 Vf가 낮아 전압 손실이 적지만,
> 역전압이 낮으므로 고전압 회로에는 부적합.

### 비교표

| 특성 | 1N4007 (실리콘) | 1N5819 (쇼트키) |
|------|:---------------:|:---------------:|
| 순방향 전압 (Vf) | ~0.7V | ~0.3V |
| 최대 역전압 | 1000V | 40V |
| 최대 전류 | 1A | 1A |
| 스위칭 속도 | 느림 | 빠름 |
| 역누설 전류 | 매우 적음 | 약간 있음 |
| 전원 보호용 | 좋음 (고전압) | 좋음 (저전압) |
| 플라이백 다이오드 | 적합 | 더 적합 (빠른 응답) |
| 가격 | 가장 저렴 | 저렴 |

### 기타 유용한 다이오드

| 다이오드 | 종류 | 역전압 | 전류 | 주요 용도 |
|----------|------|:------:|:----:|-----------|
| 1N4148 | 소신호 실리콘 | 100V | 200mA | 논리 회로, 클램핑 |
| BAT54 | 소신호 쇼트키 | 30V | 200mA | 신호 보호 |
| SS14 | 쇼트키 (SMD) | 40V | 1A | SMPS 정류 |
| 1N5822 | 쇼트키 | 40V | 3A | 대전류 플라이백 |

---

## 7. 실습: ESP32 회로에서 다이오드 활용

### 실습 1: 전원 역접속 보호 회로

```
    DC 잭 / 배터리
    ┌──────┐
    │  +   ├──▶|──────── ESP32 VIN (5V)
    │      │  1N5819
    │  -   ├──────────── ESP32 GND
    └──────┘

    ※ 쇼트키(1N5819) 사용: 전압 손실 최소화 (~0.3V)
    ※ 5V 입력 시: 5V - 0.3V = 4.7V → ESP32 정상 동작
```

### 실습 2: 릴레이 + 플라이백 다이오드

```
    5V (릴레이 전원)
     │
     ├──────────────┐
     │              │
   ┌─┴──────┐     ▶|  ← 1N4007 (플라이백)
   │ 릴레이  │      │
   │ 코일    │      │
   └─┬──────┘      │
     │              │
     ├──────────────┘
     │
     D (Drain)
   ┌─┴──┐
   │MOSFET│  ← IRLZ44N
   └─┬──┘
     S (Source)
     │
    GND

    ESP32 GPIO ──[1kΩ]── Gate (MOSFET)
```

### 실습 3: 전압 레벨 표시기 (다이오드 특성 활용)

```
    ESP32 GPIO 34 (ADC)
         │
         ├──[10kΩ]──┐
         │           │
         │          ▶|── 3.3V  ← 상한 클램핑
         │           │
         │          |◀── GND  ← 하한 클램핑
         │           │
    외부 신호 (0~5V)
```

이 회로는 외부 5V 신호를 ESP32의 3.3V ADC로 안전하게 읽기 위한 보호 회로입니다.

### 다이오드 테스트 방법 (멀티미터)

```
멀티미터 다이오드 모드 (◁| 기호):

1. 빨간 프로브 → 애노드 (+)
   검은 프로브 → 캐소드 (-) [밴드 쪽]

   표시값: 0.5~0.8V (실리콘) 또는 0.2~0.4V (쇼트키)
   → 정상!

2. 프로브를 반대로:
   빨간 프로브 → 캐소드 (-)
   검은 프로브 → 애노드 (+)

   표시값: OL (Over Limit) 또는 무한대
   → 정상! (역방향 차단)

3. 양쪽 다 OL → 다이오드 단선 (고장)
4. 양쪽 다 낮은 값 → 다이오드 단락 (고장)
```

---

## 핵심 정리

```
┌─────────────────────────────────────────────────────────┐
│                   다이오드 핵심 정리                       │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. 다이오드 = 전류를 한 방향으로만 흐르게 하는 부품        │
│     - 밴드(띠) 쪽 = 캐소드(-) = 전류 나가는 쪽            │
│                                                         │
│  2. 순방향 전압 강하 (Vf):                                │
│     - 실리콘 (1N4007): ~0.7V                             │
│     - 쇼트키 (1N5819): ~0.3V (더 효율적!)                │
│                                                         │
│  3. 주요 용도:                                           │
│     - 역접속 보호: 전원을 거꾸로 연결해도 회로 보호         │
│     - 플라이백 다이오드: 릴레이/모터 역기전력 흡수          │
│     - 전압 클램핑: 과전압으로부터 IC 보호                  │
│                                                         │
│  4. 필수 다이오드 2개:                                    │
│     - 1N4007: 범용, 고역전압(1000V), Vf ~0.7V            │
│     - 1N5819: 쇼트키, 저전압 손실, Vf ~0.3V              │
│                                                         │
│  5. 플라이백 다이오드 = 생명 보험!                         │
│     릴레이/모터 제어 시 반드시 달기!                       │
│     (안 달면 트랜지스터/MOSFET/ESP32 파손!)               │
│                                                         │
│  6. 멀티미터 다이오드 모드로 극성과 상태 확인 가능          │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

> **다음 학습:** [05. 트랜지스터/MOSFET](05-transistor-mosfet.md)에서 ESP32로 고전류/고전압 장치를 제어하는 방법을 배워봅시다!
