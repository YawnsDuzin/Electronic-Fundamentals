# 02. LED (발광 다이오드)

## 목차
1. [LED란?](#1-led란)
2. [LED의 원리](#2-led의-원리)
3. [극성 구분법](#3-극성-구분법)
4. [순방향 전압과 색상별 차이](#4-순방향-전압과-색상별-차이)
5. [전류 제한 저항 계산](#5-전류-제한-저항-계산)
6. [RGB LED](#6-rgb-led)
7. [저항 없이 연결하면 안 되는 이유](#7-저항-없이-연결하면-안-되는-이유)
8. [실습: ESP32로 LED 제어하기](#8-실습-esp32로-led-제어하기)
9. [핵심 정리](#핵심-정리)

---

## 1. LED란?

LED는 **Light Emitting Diode (발광 다이오드)**의 약자입니다.
전류가 흐르면 빛을 내는 반도체 소자입니다.

```
소프트웨어 비유:
LED는 프로그램의 "console.log()" 또는 "print()" 같은 존재입니다.
회로가 제대로 동작하는지 가장 간단하게 확인할 수 있는 출력 장치입니다.
디버깅의 시작이자, 가장 많이 사용하는 출력 수단!
```

### LED의 종류

| 종류 | 크기 | 특징 |
|------|------|------|
| 표준 LED | 3mm, 5mm | 가장 흔함, 브레드보드에 바로 꽂을 수 있음 |
| SMD LED | 0805, 1206 등 | 표면실장, PCB용 |
| 고출력 LED | 1W, 3W, 5W+ | 조명용, 히트싱크 필요 |
| RGB LED | 5mm, SMD | 빨강+초록+파랑 = 모든 색상 표현 |
| 적외선 LED | 5mm | 리모컨, 근접 센서 |

---

## 2. LED의 원리

LED는 **다이오드의 한 종류**입니다. 다이오드는 전류를 한 방향으로만 흘려보내는
반도체 소자인데, LED는 전류가 흐를 때 빛을 방출하는 특별한 다이오드입니다.

```
전류 흐름 방향:

    애노드(+) ──▶── 캐소드(-)

    ┌──────────────────────────────────────┐
    │                                      │
    │   순방향 연결 (Forward Bias)          │
    │   (+) ──▶── (-) : 전류 흐름 → 빛!    │
    │                                      │
    │   역방향 연결 (Reverse Bias)          │
    │   (-) ──◀── (+) : 전류 차단 → 안 켜짐 │
    │                                      │
    └──────────────────────────────────────┘
```

### LED의 전기적 특성

LED는 일반 저항과 달리, **일정한 전압(순방향 전압)**이 걸려야 전류가 흐르기 시작합니다.

```
    전류(I)
     ↑
     │            ╱
     │           ╱
     │          ╱  ← 전류가 급격히 증가!
     │         ╱
     │        │
     │        │  ← 순방향 전압(Vf) 도달
     │────────┘
     └─────────────────→ 전압(V)
              ↑
           Vf (예: 2.0V)
```

> **핵심 개념:** LED는 순방향 전압(Vf) 이상이 되면 전류가 급격히 증가합니다.
> 전류를 제한하지 않으면 LED가 타버립니다! → 반드시 **저항**이 필요합니다.

---

## 3. 극성 구분법

LED는 **극성이 있습니다**. 올바른 방향으로 연결해야 빛이 납니다.

### 방법 1: 다리 길이로 구분

```
    긴 다리 = 애노드(+)     짧은 다리 = 캐소드(-)

         │  │
         │  │
         │  └── 짧은 다리 = 캐소드(-)
         │
         └───── 긴 다리 = 애노드(+)

    ※ 새 LED 기준입니다. 다리를 잘랐으면 이 방법 사용 불가!
```

### 방법 2: 플랫 면(편평한 부분)으로 구분

```
         ┌───┐
        ╱     ╲
       │       │
       │       ▌ ← 플랫 면 (편평한 부분) = 캐소드(-) 쪽
       │       │
        ╲     ╱
         └───┘
         │   │
         +   -
      (긴) (짧은)
```

### 방법 3: 내부 구조로 구분

```
    LED를 위에서 들여다보면:

         ┌─────────┐
         │  작은쪽  │ ← 작은 금속판 = 애노드(+)
         │    △    │
         │   ╱ ╲   │
         │  ╱   ╲  │
         │ ╱ 큰쪽╲ │ ← 큰 금속판(깃발 모양) = 캐소드(-)
         └─────────┘
           │     │
           +     -
```

### 방법 4: 멀티미터 다이오드 모드

```
멀티미터를 다이오드 측정 모드(◁| 기호)로 설정:

    빨간 프로브 → 애노드(+)
    검은 프로브 → 캐소드(-)

    올바르게 연결하면:
    - 멀티미터에 순방향 전압(0.6~3.0V)이 표시됨
    - LED가 약하게 빛남

    반대로 연결하면:
    - "OL" 또는 무한대 표시
    - LED가 켜지지 않음
```

### 회로도 기호

```
    LED 기호:

        애노드(+)     캐소드(-)
           │              │
           ├──▶|──────────┤
           │    ↑          │
           │   삼각형 방향  │
           │   = 전류 방향  │

    삼각형의 꼭지점이 가리키는 방향이 전류가 흐르는 방향입니다.
    세로 막대(|)가 있는 쪽이 캐소드(-)입니다.
```

---

## 4. 순방향 전압과 색상별 차이

LED의 순방향 전압(Vf)은 **LED의 색상(파장)**에 따라 다릅니다.
이 값을 알아야 전류 제한 저항을 정확하게 계산할 수 있습니다.

### 색상별 순방향 전압 표

| LED 색상 | 파장 (nm) | 순방향 전압 (Vf) | 일반적 전류 | 비고 |
|----------|:---------:|:---------------:|:----------:|------|
| 적외선 (IR) | 940 | 1.1~1.5V | 20mA | 리모컨용 |
| 빨강 (Red) | 620~645 | 1.8~2.2V | 20mA | 가장 낮은 Vf |
| 주황 (Orange) | 600~620 | 2.0~2.2V | 20mA | |
| 노랑 (Yellow) | 580~600 | 2.0~2.2V | 20mA | |
| 초록 (Green) | 520~570 | 2.0~3.0V | 20mA | 종류에 따라 차이 큼 |
| 파랑 (Blue) | 460~490 | 3.0~3.4V | 20mA | 높은 Vf |
| 흰색 (White) | - | 3.0~3.4V | 20mA | 파랑 LED + 형광체 |
| UV (자외선) | 380~420 | 3.0~3.6V | 20mA | |

> **기억할 것:** 빨강 계열은 Vf가 낮고(~2V), 파랑/흰색은 Vf가 높습니다(~3.2V).
> ESP32의 GPIO 출력이 3.3V이므로, 파랑/흰색 LED는 전압이 부족할 수 있습니다.

---

## 5. 전류 제한 저항 계산

### 공식

```
R = (V_source - V_f) / I_LED

여기서:
  V_source = 전원 전압 (ESP32 GPIO는 3.3V)
  V_f      = LED의 순방향 전압
  I_LED    = 원하는 LED 전류 (보통 5~20mA)
  R        = 필요한 저항값
```

### 계산 예제 1: 빨간 LED (3.3V)

```
조건:
  V_source = 3.3V (ESP32 GPIO)
  V_f = 2.0V (빨간 LED)
  I_LED = 10mA (적당한 밝기)

계산:
  R = (3.3V - 2.0V) / 0.010A
  R = 1.3V / 0.010A
  R = 130Ω

→ 표준 저항값: 150Ω 또는 220Ω 선택
```

### 계산 예제 2: 파란 LED (3.3V)

```
조건:
  V_source = 3.3V (ESP32 GPIO)
  V_f = 3.2V (파란 LED)
  I_LED = 10mA

계산:
  R = (3.3V - 3.2V) / 0.010A
  R = 0.1V / 0.010A
  R = 10Ω

→ 전압 여유가 겨우 0.1V!
→ LED가 어둡거나, 불안정하게 동작할 수 있음
→ 해결: 5V 전원 사용하거나, 저전류 고효율 LED 사용
```

### 계산 예제 3: 빨간 LED (5V 전원)

```
조건:
  V_source = 5V (USB 또는 외부 전원)
  V_f = 2.0V (빨간 LED)
  I_LED = 15mA

계산:
  R = (5V - 2.0V) / 0.015A
  R = 3.0V / 0.015A
  R = 200Ω

→ 표준 저항값: 220Ω 선택
```

### 빠른 참조표 (ESP32 3.3V 기준)

| LED 색상 | Vf (대표값) | 5mA 저항 | 10mA 저항 | 15mA 저항 | 20mA 저항 |
|----------|:----------:|:--------:|:--------:|:--------:|:--------:|
| 빨강 | 2.0V | 270Ω | 130Ω | 87Ω | 65Ω |
| 노랑 | 2.1V | 240Ω | 120Ω | 80Ω | 60Ω |
| 초록 | 2.2V | 220Ω | 110Ω | 73Ω | 55Ω |
| 파랑 | 3.2V | 22Ω | 10Ω | - | - |
| 흰색 | 3.2V | 22Ω | 10Ω | - | - |

> **실용적 팁:** 정확한 계산이 귀찮다면, ESP32 3.3V에서:
> - 빨강/노랑/초록 LED → **220Ω** 사용 (안전하고 적당한 밝기)
> - 파랑/흰색 LED → **5V 전원 + 100Ω** 사용

---

## 6. RGB LED

RGB LED는 하나의 패키지 안에 **빨강(R), 초록(G), 파랑(B)** 세 개의 LED가 들어 있습니다.

### 종류

```
공통 캐소드 (Common Cathode):          공통 애노드 (Common Anode):

   R    G    B                          R    G    B
   │    │    │                          │    │    │
  [R1] [R2] [R3]                       [R1] [R2] [R3]
   │    │    │                          │    │    │
   ├►│  ├►│  ├►│                       │◄├  │◄├  │◄├
   │    │    │                          │    │    │
   └────┼────┘                          └────┼────┘
        │                                    │
       GND (공통-)                         VCC (공통+)

   ※ 공통 캐소드가 더 직관적이라 초보자에게 추천!
```

### 핀 배치 (4핀 RGB LED)

```
    정면에서 바라본 모습:

        ┌─────┐
       ╱       ╲
      │         │
      │  R G B  │
      │         │
       ╲       ╱
        └─────┘
        │││ │
        │││ │
        ││└─┘
        ││  가장 긴 핀 = 공통 핀
        ││
        │└── 핀 2
        │
        └─── 핀 1

    공통 캐소드 기준:
    핀 1: Red (빨강)
    핀 2: 공통 GND (가장 긴 핀)
    핀 3: Green (초록)
    핀 4: Blue (파랑)

    ※ 제조사마다 핀 배치가 다를 수 있으니 데이터시트를 꼭 확인하세요!
```

### 색상 혼합

```
색상 혼합 원리 (가산 혼합):

    빨강(R) + 초록(G) = 노랑(Yellow)
    빨강(R) + 파랑(B) = 자홍(Magenta)
    초록(G) + 파랑(B) = 청록(Cyan)
    빨강(R) + 초록(G) + 파랑(B) = 흰색(White)

    PWM으로 각 색의 밝기를 조절하면 수백만 가지 색상 표현 가능!
```

### ESP32로 RGB LED 제어 (Arduino 코드)

```cpp
// 공통 캐소드 RGB LED 제어
const int RED_PIN   = 16;
const int GREEN_PIN = 17;
const int BLUE_PIN  = 18;

// ESP32 LEDC (PWM) 채널 설정
const int FREQ = 5000;
const int RESOLUTION = 8;  // 0~255

void setup() {
    // ESP32 LEDC PWM 채널 설정
    ledcAttach(RED_PIN, FREQ, RESOLUTION);
    ledcAttach(GREEN_PIN, FREQ, RESOLUTION);
    ledcAttach(BLUE_PIN, FREQ, RESOLUTION);
}

void setColor(int r, int g, int b) {
    ledcWrite(RED_PIN, r);      // 0~255
    ledcWrite(GREEN_PIN, g);    // 0~255
    ledcWrite(BLUE_PIN, b);     // 0~255
}

void loop() {
    setColor(255, 0, 0);    // 빨강
    delay(1000);
    setColor(0, 255, 0);    // 초록
    delay(1000);
    setColor(0, 0, 255);    // 파랑
    delay(1000);
    setColor(255, 255, 0);  // 노랑
    delay(1000);
    setColor(255, 0, 255);  // 자홍
    delay(1000);
    setColor(0, 255, 255);  // 청록
    delay(1000);
    setColor(255, 255, 255); // 흰색
    delay(1000);
}
```

---

## 7. 저항 없이 연결하면 안 되는 이유

### 저항 없이 연결하면 어떻게 되나?

```
잘못된 연결 (절대 하지 마세요!):

    ESP32 GPIO (3.3V) ──── ┤►├ ──── GND
                           LED
                         (저항 없음)

무슨 일이 벌어지나?

1. LED의 순방향 전압(~2V) 이상의 전압이 걸림
2. 전류를 제한하는 것이 없음
3. LED에 과도한 전류가 흐름 (수백 mA!)
4. 결과:
   ├── LED 즉시 파손 (타버림)
   ├── ESP32 GPIO 핀 손상 (최대 출력 전류 초과)
   └── 최악의 경우: ESP32 보드 전체 고장
```

### ESP32 GPIO의 전류 제한

```
ESP32 GPIO 사양:
┌──────────────────────────────────────┐
│ 단일 핀 최대 출력 전류: 약 40mA      │
│ 권장 출력 전류:        약 20mA 이하  │
│ 전체 GPIO 합산 최대:   약 1.2A       │
│                                      │
│ ※ 20mA 이상 흘리면 핀이 손상될 수    │
│   있습니다!                          │
└──────────────────────────────────────┘
```

### 올바른 연결 vs 잘못된 연결

```
잘못된 연결 (X):                     올바른 연결 (O):

GPIO ──┤►├── GND                    GPIO ──[220Ω]──┤►├── GND
     LED만 있음                           저항    LED
   (과전류 → 파손!)                    (전류 제한 → 안전!)
```

### 왜 LED 자체가 전류를 제한하지 못하나?

```
일반 저항:                    LED (다이오드):
전압이 높아지면               순방향 전압(Vf) 이상이 되면
전류가 비례해서 증가           전류가 급격히 증가!
(선형적)                      (비선형적, 지수적)

V ──/\/\/\── I              V ──▶|── I
   R = V/I                    Vf 이상에서 저항 ≈ 0

저항 = 일정                   저항 ≈ 0에 가까움
(전류를 제한해줌)              (전류를 제한하지 못함!)
```

> **결론:** LED는 스스로 전류를 제한할 수 없으므로, 반드시 외부에 저항을 달아야 합니다.
> 이것은 선택이 아닌 **필수**입니다!

---

## 8. 실습: ESP32로 LED 제어하기

### 실습 1: LED 깜빡이기 (Blink)

#### 회로 연결

```
    ESP32 DevKit
    ┌──────────────┐
    │              │
    │    GPIO 2    ├───[220Ω]───┤►├───┐
    │              │            LED    │
    │              │          (빨간색) │
    │              │                   │
    │     GND      ├───────────────────┘
    │              │
    └──────────────┘
```

#### 브레드보드 배치

```
    ESP32          브레드보드
    ┌────┐    ┌──────────────────────┐
    │    │    │                      │
    │ G2 ├────┤ a1 ─── [220Ω] ─── e1│
    │    │    │                      │
    │    │    │ f1 ─── ┤►├ ─── j1    │
    │    │    │        LED           │
    │    │    │                      │
    │GND ├────┤ (-) 레일 ──────── j1 │
    │    │    │                      │
    └────┘    └──────────────────────┘

    ※ 실제로는 같은 행(row)의 핀을 사용합니다.
```

#### 코드

```cpp
const int LED_PIN = 2;

void setup() {
    pinMode(LED_PIN, OUTPUT);
    Serial.begin(115200);
    Serial.println("LED Blink 시작!");
}

void loop() {
    digitalWrite(LED_PIN, HIGH);
    Serial.println("LED ON");
    delay(500);

    digitalWrite(LED_PIN, LOW);
    Serial.println("LED OFF");
    delay(500);
}
```

### 실습 2: LED 밝기 조절 (PWM)

```cpp
const int LED_PIN = 2;
const int FREQ = 5000;       // 5kHz
const int RESOLUTION = 8;    // 8비트 (0~255)

void setup() {
    ledcAttach(LED_PIN, FREQ, RESOLUTION);
}

void loop() {
    // 점점 밝아지기
    for (int brightness = 0; brightness <= 255; brightness++) {
        ledcWrite(LED_PIN, brightness);
        delay(10);
    }

    // 점점 어두워지기
    for (int brightness = 255; brightness >= 0; brightness--) {
        ledcWrite(LED_PIN, brightness);
        delay(10);
    }
}
```

### 실습 3: 여러 LED 순차 점등 (LED Chaser)

#### 회로 연결

```
    ESP32
    ┌──────────────┐
    │    GPIO 16   ├───[220Ω]───┤►├─── GND   (LED 1, 빨강)
    │    GPIO 17   ├───[220Ω]───┤►├─── GND   (LED 2, 노랑)
    │    GPIO 18   ├───[220Ω]───┤►├─── GND   (LED 3, 초록)
    │    GPIO 19   ├───[220Ω]───┤►├─── GND   (LED 4, 빨강)
    │              │
    │     GND      ├──────────────────── GND (공통)
    └──────────────┘
```

#### 코드

```cpp
const int LED_PINS[] = {16, 17, 18, 19};
const int NUM_LEDS = 4;

void setup() {
    for (int i = 0; i < NUM_LEDS; i++) {
        pinMode(LED_PINS[i], OUTPUT);
    }
}

void loop() {
    // 순차 점등
    for (int i = 0; i < NUM_LEDS; i++) {
        digitalWrite(LED_PINS[i], HIGH);
        delay(200);
        digitalWrite(LED_PINS[i], LOW);
    }

    // 역순 점등
    for (int i = NUM_LEDS - 1; i >= 0; i--) {
        digitalWrite(LED_PINS[i], HIGH);
        delay(200);
        digitalWrite(LED_PINS[i], LOW);
    }
}
```

---

## 핵심 정리

```
┌─────────────────────────────────────────────────────────┐
│                    LED 핵심 정리                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. LED = 발광 다이오드 (빛을 내는 반도체)                 │
│                                                         │
│  2. 극성이 있다!                                         │
│     - 긴 다리 = 애노드(+) → 전원 쪽                      │
│     - 짧은 다리 / 플랫 면 = 캐소드(-) → GND 쪽            │
│                                                         │
│  3. 순방향 전압 (Vf):                                    │
│     - 빨강: ~2.0V / 초록: ~2.2V / 파랑,흰색: ~3.2V       │
│                                                         │
│  4. 저항 계산: R = (V_source - Vf) / I_LED               │
│     - ESP32 (3.3V) + 빨간 LED → 220Ω 사용               │
│                                                         │
│  5. 절대 저항 없이 연결하면 안 됨!                         │
│     - LED 파손 + ESP32 GPIO 손상 위험                     │
│                                                         │
│  6. RGB LED = 빨강 + 초록 + 파랑                         │
│     - PWM으로 각 색상 밝기 조절 → 다양한 색 표현           │
│                                                         │
│  7. ESP32 GPIO 최대 출력 전류: ~40mA (권장 20mA 이하)     │
│                                                         │
│  8. 파랑/흰색 LED는 3.3V에서 전압 부족 → 5V 전원 권장      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

> **다음 학습:** [03. 커패시터(콘덴서)](03-capacitor.md)에서 에너지 저장과 노이즈 필터링을 배워봅시다!
