# Phase 5: 전원 설계 (Power Design)

## 개요

전원 설계는 전자 회로의 **심장**과 같습니다. 아무리 훌륭한 회로를 설계하더라도 전원이 불안정하면
시스템 전체가 오동작하거나 부품이 손상될 수 있습니다.

이 Phase에서는 ESP32 기반 프로젝트를 위한 안정적인 전원 설계 방법을 처음부터 끝까지 배웁니다.

```
    ┌─────────────────────────────────────────────────────────┐
    │                   Phase 5: 전원 설계                      │
    │                                                         │
    │   ┌─────────┐    ┌──────────┐    ┌──────────┐          │
    │   │ 전원     │───▶│ 변환/조절 │───▶│ 부하     │          │
    │   │ (입력)   │    │ (레귤레이터)│   │ (ESP32등)│          │
    │   └─────────┘    └──────────┘    └──────────┘          │
    │        │              │               │                 │
    │        ▼              ▼               ▼                 │
    │   ┌─────────┐    ┌──────────┐    ┌──────────┐          │
    │   │ 보호 회로 │    │ 노이즈    │    │ 소비 전류 │          │
    │   │ (퓨즈 등) │    │ 필터링    │    │ 계산     │          │
    │   └─────────┘    └──────────┘    └──────────┘          │
    └─────────────────────────────────────────────────────────┘
```

---

## 학습 목표

이 Phase를 완료하면 다음을 할 수 있습니다:

1. **전원 용량을 정확히 계산**하여 적절한 어댑터/배터리를 선정할 수 있다
2. **3.3V와 5V 로직 레벨**의 차이를 이해하고 안전하게 혼용할 수 있다
3. **LDO와 DC-DC 컨버터**의 차이를 알고 상황에 맞게 선택할 수 있다
4. **회로 보호 기법**을 적용하여 안전한 회로를 설계할 수 있다

---

## 커리큘럼 구성

| 순서 | 파일명 | 주제 | 핵심 내용 |
|------|--------|------|-----------|
| 01 | `01-power-calculation.md` | 전원 용량 계산 | 소비 전류 합산, 배터리 수명 계산, 여유율 적용 |
| 02 | `02-voltage-levels.md` | 3.3V vs 5V 레벨 | 로직 레벨 차이, 레벨 시프터, 전압 분배기 |
| 03 | `03-regulator-vs-dcdc.md` | 레귤레이터 vs DC-DC | LDO 원리, 스위칭 레귤레이터, 효율 비교 |
| 04 | `04-protection.md` | 회로 보호 | 역극성, 과전류, 서지, ESD 보호 |

### 실습 도구

| 파일명 | 설명 |
|--------|------|
| `examples/power_budget_calculator.py` | Python 전원 예산 계산기 (실행 가능) |

---

## 전원 설계의 전체 흐름

전원 설계는 다음 순서로 진행합니다:

```
Step 1: 소비 전류 파악
    │
    ▼
Step 2: 전원 용량 결정 (여유율 포함)
    │
    ▼
Step 3: 전압 레벨 확인 (3.3V? 5V? 혼용?)
    │
    ▼
Step 4: 전압 변환 방식 선택 (LDO vs DC-DC)
    │
    ▼
Step 5: 보호 회로 추가
    │
    ▼
Step 6: 테스트 및 검증
```

---

## 선수 지식

이 Phase를 시작하기 전에 다음 내용을 알고 있어야 합니다:

- **옴의 법칙**: V = I x R
- **전력 공식**: P = V x I
- **기본 회로 연결**: 직렬, 병렬 연결
- **ESP32 기본 사용법**: GPIO, Wi-Fi 등

---

## 왜 전원 설계가 중요한가?

### 실제 프로젝트에서 겪는 전원 문제들

| 증상 | 원인 | 해결 |
|------|------|------|
| ESP32가 자꾸 리셋됨 | 전원 용량 부족 (Wi-Fi 켤 때 전류 스파이크) | 충분한 전류 용량의 어댑터 사용 |
| 센서 값이 불안정함 | 전원 노이즈 | 디커플링 커패시터 추가 |
| 5V 센서 연결 후 ESP32 고장 | 로직 레벨 불일치 (5V → 3.3V GPIO) | 레벨 시프터 사용 |
| 배터리가 예상보다 빨리 방전 | 소비 전류 계산 오류 | 정확한 전력 예산 수립 |
| 어댑터가 뜨거움 | 비효율적인 레귤레이터 | DC-DC 컨버터로 교체 |

---

## 핵심 공식 요약

```
┌─────────────────────────────────────────────────────────┐
│                    핵심 공식 모음                          │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  전력:        P = V × I                                  │
│                                                         │
│  전류 합산:   I_total = I₁ + I₂ + I₃ + ...              │
│                                                         │
│  배터리 수명: T(h) = 배터리 용량(mAh) ÷ 소비 전류(mA)    │
│                                                         │
│  여유율 적용: I_설계 = I_total × 1.3 (30% 마진)          │
│                                                         │
│  LDO 발열:   P_열 = (V_in - V_out) × I                  │
│                                                         │
│  LDO 효율:   η = V_out ÷ V_in × 100%                   │
│                                                         │
│  전압 분배:   V_out = V_in × R₂ ÷ (R₁ + R₂)            │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 학습 방법 추천

1. **순서대로 학습하세요** - 각 챕터는 이전 내용을 기반으로 합니다
2. **직접 계산해 보세요** - 공식을 외우는 것보다 직접 계산하는 것이 효과적입니다
3. **Python 계산기를 활용하세요** - `examples/power_budget_calculator.py`로 실습하세요
4. **데이터시트를 읽어보세요** - 실제 부품의 데이터시트에서 스펙을 확인하는 습관을 들이세요

---

## 준비물 (선택사항)

실습을 위해 다음 부품이 있으면 좋습니다 (없어도 이론 학습 가능):

- ESP32 개발 보드
- 멀티미터 (전류 측정 가능한 것)
- AMS1117-3.3 LDO 레귤레이터
- 레벨 시프터 모듈 (BSS138 기반)
- 각종 저항 (1kΩ, 2kΩ, 10kΩ 등)
- 브레드보드 및 점퍼 와이어

---

> **다음 단계**: [01-power-calculation.md](./01-power-calculation.md)로 이동하여 전원 용량 계산부터 시작하세요!
