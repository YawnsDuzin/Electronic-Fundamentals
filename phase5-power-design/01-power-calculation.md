# 01. 전원 용량 계산 (Power Budget Calculation)

## 개요

전원 설계의 첫 번째 단계는 **"내 회로가 얼마나 많은 전류를 소비하는가?"**를 파악하는 것입니다.
이 값을 정확히 계산해야 적절한 어댑터나 배터리를 선정할 수 있고, 안정적으로 동작하는 시스템을
만들 수 있습니다.

```
    전원 용량 계산의 핵심 질문:

    ┌─────────────────────────────────┐
    │  1. 각 부품이 얼마나 먹나? (mA)  │
    │  2. 전부 합치면 얼마인가?        │
    │  3. 여유는 얼마나 줄 것인가?     │
    │  4. 어떤 전원을 쓸 것인가?       │
    └─────────────────────────────────┘
```

---

## 1. 각 부품의 소비 전류 확인법

### 1.1 데이터시트에서 확인하기

모든 전자 부품에는 **데이터시트(Datasheet)**라는 기술 문서가 있습니다.
데이터시트에서 전류 관련 항목을 찾는 방법을 알아봅시다.

#### 데이터시트에서 찾아야 할 항목

| 항목 | 영문 표기 | 의미 |
|------|-----------|------|
| 동작 전류 | Operating Current / I_CC / I_DD | 정상 동작 시 소비 전류 |
| 대기 전류 | Standby Current / I_SB | 대기 모드 시 소비 전류 |
| 슬립 전류 | Sleep Current / I_sleep | 슬립 모드 시 소비 전류 |
| 피크 전류 | Peak Current / I_peak | 순간 최대 전류 |
| 최대 전류 | Maximum Current / I_max | 절대 최대 정격 전류 |

#### 데이터시트 읽기 예시: ESP32

```
ESP32 데이터시트의 전류 소비 섹션:

┌───────────────────────────────────────────────────────┐
│  ESP32 Current Consumption (전류 소비)                 │
├───────────────────────────────────────────────────────┤
│                                                       │
│  Mode                    │ Typical    │ Max           │
│  ─────────────────────────────────────────────        │
│  Active (Wi-Fi TX)       │ 240 mA     │ 380 mA       │
│  Active (Wi-Fi RX)       │ 100 mA     │ 130 mA       │
│  Active (BT TX)          │ 130 mA     │ 200 mA       │
│  Modem Sleep             │  20 mA     │  30 mA       │
│  Light Sleep             │ 0.8 mA     │  1.2 mA      │
│  Deep Sleep              │  10 μA     │  20 μA        │
│  Hibernation             │   5 μA     │  10 μA        │
│                                                       │
└───────────────────────────────────────────────────────┘
```

> **팁**: 데이터시트를 처음 읽을 때는 "Electrical Characteristics" 또는
> "Power Consumption" 섹션을 먼저 찾으세요. 보통 문서의 중간~후반부에 있습니다.

### 1.2 데이터시트가 없을 때

저렴한 중국산 모듈 등은 데이터시트가 없거나 불완전할 수 있습니다.
이 경우 다음 방법으로 소비 전류를 파악합니다:

1. **멀티미터로 직접 측정**: 전원선에 멀티미터를 직렬로 연결하여 전류를 측정
2. **유사 부품의 데이터시트 참고**: 같은 칩을 사용하는 다른 모듈의 자료 참고
3. **온라인 커뮤니티 검색**: 다른 사용자가 측정한 값 참고
4. **보수적으로 추정**: 확실하지 않으면 넉넉하게 잡기

#### 멀티미터로 전류 측정하는 방법

```
    전류 측정 연결 방법 (직렬 연결):

    ┌──────────┐
    │ 전원(+)   │
    └────┬─────┘
         │
    ┌────┴─────┐
    │ 멀티미터  │  ◀── mA 또는 A 레인지로 설정
    │ (COM, mA) │      적색 리드 → mA/A 단자
    └────┬─────┘      흑색 리드 → COM 단자
         │
    ┌────┴─────┐
    │ 부품(VCC) │
    └────┬─────┘
         │
    ┌────┴─────┐
    │ 전원(GND) │  ◀── 부품의 GND와 전원의 GND 연결
    └──────────┘

    ※ 주의: 전류 측정은 반드시 직렬로!
       병렬로 연결하면 멀티미터가 고장납니다!
```

---

## 2. ESP32의 소비 전류 상세

ESP32는 동작 모드에 따라 소비 전류가 극적으로 변합니다.

### 2.1 ESP32 동작 모드별 소비 전류

| 동작 모드 | 소비 전류 (Typical) | 설명 |
|-----------|---------------------|------|
| **Active (Wi-Fi TX)** | ~240 mA | Wi-Fi 데이터 전송 중 |
| **Active (Wi-Fi RX)** | ~100 mA | Wi-Fi 데이터 수신 중 |
| **Active (BT TX)** | ~130 mA | 블루투스 전송 중 |
| **Active (CPU만)** | ~30~50 mA | Wi-Fi/BT 끄고 CPU만 동작 |
| **Modem Sleep** | ~20 mA | Wi-Fi 모뎀 끔, CPU 동작 |
| **Light Sleep** | ~0.8 mA | CPU 일시 정지, RAM 유지 |
| **Deep Sleep** | ~10 μA | RTC만 동작, RAM 소실 |
| **Hibernation** | ~5 μA | 최소 동작, 타이머 깨우기만 |

### 2.2 ESP32 전류 소비 시간 그래프 (개념도)

```
전류(mA)
  400 ┤
      │
  350 ┤
      │          ┌─┐
  300 ┤          │ │
      │          │ │      Wi-Fi TX
  250 ┤       ┌──┘ │      (피크: ~240mA)
      │       │    │
  200 ┤       │    │
      │       │    │
  150 ┤       │    └──┐
      │       │       │   Wi-Fi RX
  100 ┤       │       │   (~100mA)
      │       │       │
   50 ┤  ┌────┘       └────┐
      │  │  CPU 동작         │  CPU 동작
   20 ┤──┘  (~30mA)         └──────────
      │
    0 ┼────────────────────────────────▶ 시간
        부팅  초기화  연결   데이터   대기
                           전송
```

### 2.3 중요한 순간 전류 (Inrush Current)

ESP32가 Wi-Fi를 활성화하는 순간, 매우 짧은 시간 동안 **최대 380mA**까지
전류가 치솟을 수 있습니다. 이를 **돌입 전류(Inrush Current)** 또는
**피크 전류(Peak Current)**라고 합니다.

```
    ⚠️  주의사항
    ─────────────────────────────────────────
    전원 어댑터나 레귤레이터를 선정할 때는
    평균 전류가 아니라 피크 전류를 기준으로
    선정해야 합니다!

    예: 평균 150mA라도, 피크가 380mA이면
        최소 500mA 이상의 전원이 필요합니다.
    ─────────────────────────────────────────
```

---

## 3. 센서별 일반적인 소비 전류

### 3.1 센서/모듈 소비 전류 표

아래는 ESP32 프로젝트에서 자주 사용되는 센서와 모듈의 일반적인 소비 전류입니다.

| 부품 | 동작 전압 | 동작 전류 (Typical) | 대기 전류 | 비고 |
|------|-----------|---------------------|-----------|------|
| **온습도 센서** | | | | |
| DHT11 | 3.3~5V | 0.3 mA | 60 μA | 저가형 |
| DHT22 | 3.3~5V | 1.5 mA | 50 μA | 정밀형 |
| SHT30 | 2.4~5.5V | 0.6 mA | 0.2 μA | I2C 인터페이스 |
| BME280 | 1.8~3.6V | 0.35 mA | 0.1 μA | 온습도+기압 |
| **디스플레이** | | | | |
| SSD1306 OLED (0.96") | 3.3~5V | 20 mA | - | I2C, 128x64 |
| SSD1306 OLED (1.3") | 3.3~5V | 30 mA | - | I2C, 128x64 |
| LCD 1602 (I2C) | 5V | 40 mA | - | 백라이트 포함 |
| TFT LCD (1.8") | 3.3V | 50 mA | - | SPI 인터페이스 |
| **액추에이터** | | | | |
| 릴레이 모듈 (5V) | 5V | 70~80 mA | 5 mA | 코일 전류 포함 |
| SG90 서보모터 | 4.8~6V | 150~500 mA | 10 mA | 부하에 따라 변동 |
| 부저 (능동형) | 3.3~5V | 25~30 mA | 0 mA | 소리 출력 시 |
| **통신 모듈** | | | | |
| nRF24L01 | 3.3V | 12 mA (TX) | 22 μA | 2.4GHz 무선 |
| HC-05 (BT) | 3.3~6V | 30~40 mA | 2 mA | 블루투스 시리얼 |
| SIM800L (GSM) | 3.4~4.4V | 200 mA (피크 2A!) | 1 mA | 셀룰러 |
| **기타** | | | | |
| SD 카드 모듈 | 3.3V | 100 mA (쓰기 시) | 0.2 mA | SPI 인터페이스 |
| WS2812B LED (1개) | 5V | 60 mA (최대) | 1 mA | RGB LED, 흰색 최대 |
| PIR 센서 (HC-SR501) | 5V | 0.065 mA | 0.065 mA | 적외선 감지 |
| 초음파 (HC-SR04) | 5V | 15 mA | 2 mA | 거리 측정 |

> **주의**: 위 값은 일반적인 참고 값입니다. 실제 값은 제조사와 사용 조건에 따라
> 다를 수 있으므로, 반드시 해당 부품의 데이터시트를 확인하세요.

---

## 4. 전류 합산 방법

### 4.1 기본 원리

회로에서 모든 부품은 전원에 **병렬**로 연결됩니다.
병렬 연결에서의 총 전류는 각 부품의 전류를 **단순 합산**합니다.

```
    전원(VCC) ──┬──────┬──────┬──────┬──── ...
                │      │      │      │
              ┌─┴─┐  ┌─┴─┐  ┌─┴─┐  ┌─┴─┐
              │ESP │  │센서│  │OLED│  │릴레│
              │ 32 │  │   │  │   │  │이  │
              └─┬─┘  └─┬─┘  └─┬─┘  └─┬─┘
                │      │      │      │
    전원(GND) ──┴──────┴──────┴──────┴──── ...

    I_total = I_ESP32 + I_센서 + I_OLED + I_릴레이 + ...
```

### 4.2 동작 모드를 고려한 합산

실제로 모든 부품이 항상 최대 전류를 소비하는 것은 아닙니다.
**동작 시나리오**를 나누어 계산하면 더 정확합니다.

| 시나리오 | 설명 |
|----------|------|
| **최대 부하 (Worst Case)** | 모든 부품이 동시에 최대 전류를 소비하는 상태 |
| **일반 동작 (Typical)** | 평소 동작 시의 평균 전류 |
| **대기/슬립 (Standby)** | 절전 모드 시 전류 |

> 전원 설계 시에는 반드시 **최대 부하(Worst Case)**를 기준으로 설계합니다!

---

## 5. 전원 용량 계산 예제

### 5.1 프로젝트: ESP32 + SHT30 + OLED + 릴레이 시스템

스마트홈 온습도 모니터링 시스템을 만든다고 가정합니다.

#### 시스템 구성

```
    ┌───────────────────────────────────────────┐
    │         스마트홈 온습도 모니터 시스템         │
    ├───────────────────────────────────────────┤
    │                                           │
    │  ┌────────┐  I2C  ┌────────┐              │
    │  │ SHT30  │◀─────▶│        │              │
    │  │ 온습도  │       │        │  GPIO  ┌───┐ │
    │  └────────┘       │ ESP32  │───────▶│릴레│ │
    │                   │        │        │이  │ │
    │  ┌────────┐  I2C  │        │        └───┘ │
    │  │ OLED   │◀─────▶│        │              │
    │  │ 디스플레이│      └────────┘              │
    │  └────────┘                               │
    │                                           │
    │  동작: 10초마다 온습도 읽기 → 화면 표시      │
    │        30도 이상이면 릴레이로 팬 켜기         │
    └───────────────────────────────────────────┘
```

#### Step 1: 각 부품의 소비 전류 파악

| 부품 | 동작 전류 | 대기/슬립 전류 | 피크 전류 |
|------|-----------|---------------|-----------|
| ESP32 (Wi-Fi 활성) | 240 mA | 10 μA (Deep Sleep) | 380 mA |
| SHT30 | 0.6 mA | 0.2 μA | 1.5 mA |
| OLED SSD1306 (0.96") | 20 mA | - | 25 mA |
| 릴레이 모듈 (5V, 1채널) | 75 mA | 5 mA | 80 mA |

#### Step 2: 시나리오별 전류 합산

**시나리오 A: 최대 부하 (Wi-Fi + 릴레이 ON)**

```
    ESP32 (Wi-Fi TX):     240.0 mA
    SHT30 (측정 중):         0.6 mA
    OLED (표시 중):         20.0 mA
    릴레이 (ON):            75.0 mA
    ─────────────────────────────────
    합계:                  335.6 mA
```

**시나리오 B: 일반 동작 (Wi-Fi OFF, 릴레이 OFF)**

```
    ESP32 (CPU만):         40.0 mA
    SHT30 (측정 중):         0.6 mA
    OLED (표시 중):         20.0 mA
    릴레이 (대기):           5.0 mA
    ─────────────────────────────────
    합계:                   65.6 mA
```

**시나리오 C: 피크 전류 (Wi-Fi 연결 순간 + 릴레이 ON)**

```
    ESP32 (Wi-Fi 피크):    380.0 mA
    SHT30 (피크):            1.5 mA
    OLED (피크):            25.0 mA
    릴레이 (ON 순간):       80.0 mA
    ─────────────────────────────────
    합계:                  486.5 mA
```

#### Step 3: 여유율 적용

```
    ┌─────────────────────────────────────────────┐
    │          여유율(마진) 적용 공식               │
    │                                             │
    │  설계 전류 = 최대 부하 전류 × (1 + 마진율)    │
    │                                             │
    │  - 일반적인 마진: 20~30%                     │
    │  - 안전 설계 시: 50%                         │
    │  - 피크 전류가 큰 경우: 30% 이상 권장        │
    └─────────────────────────────────────────────┘
```

**30% 여유율 적용:**

```
    최대 부하:  335.6 mA × 1.3 = 436.3 mA
    피크 기준:  486.5 mA × 1.3 = 632.5 mA
```

#### Step 4: 적절한 전원 선정

| 전원 옵션 | 용량 | 적합 여부 | 이유 |
|-----------|------|-----------|------|
| USB (컴퓨터) | 500 mA | 아슬아슬 | 피크 시 부족할 수 있음 |
| USB 충전기 (1A) | 1000 mA | **적합** | 충분한 여유 |
| USB 충전기 (2A) | 2000 mA | **매우 적합** | 넉넉한 여유 |
| 5V/2A 어댑터 | 2000 mA | **매우 적합** | 전용 어댑터 |
| 18650 배터리 (3.7V) | 2600~3400 mAh | **적합** | LDO/DC-DC 필요 |

**결론: 5V/1A 이상의 어댑터를 사용합니다.**

---

## 6. 적절한 어댑터/배터리 선정 방법

### 6.1 어댑터(SMPS) 선정 가이드

| 기준 | 확인 사항 |
|------|-----------|
| **출력 전압** | 부품의 동작 전압과 일치하는가? (보통 5V 또는 3.3V) |
| **출력 전류** | 최대 부하 전류의 1.3배 이상인가? |
| **인증 마크** | KC, UL, CE 등 안전 인증이 있는가? |
| **커넥터** | USB, DC잭 등 연결 방식이 맞는가? |
| **리플/노이즈** | 센서용이면 저노이즈 제품인가? |

### 6.2 배터리 선정 가이드

일반적으로 ESP32 프로젝트에 사용하는 배터리:

| 배터리 종류 | 공칭 전압 | 용량 예시 | 특징 |
|-------------|-----------|-----------|------|
| 18650 리튬이온 | 3.7V | 2600~3400 mAh | 가장 많이 사용 |
| 리포(LiPo) | 3.7V | 500~10000 mAh | 얇고 가벼움 |
| AA 건전지 x3 | 4.5V (3x1.5V) | 2000~2500 mAh | 구하기 쉬움 |
| CR123A | 3V | 1500 mAh | 소형, 고가 |
| 18650 x2 (직렬) | 7.4V | 2600~3400 mAh | DC-DC 필요 |

```
    ⚠️  배터리 사용 시 주의사항
    ─────────────────────────────────────────
    1. 리튬 배터리는 반드시 보호 회로(BMS) 사용
    2. 과방전 방지: 3.0V 이하로 내려가지 않도록
    3. 과충전 방지: 4.2V 이상으로 올라가지 않도록
    4. 단락(쇼트) 주의: 화재 위험!
    ─────────────────────────────────────────
```

---

## 7. 배터리 수명 계산

### 7.1 기본 공식

```
    ┌─────────────────────────────────────────────┐
    │                                             │
    │   배터리 수명(시간) = 배터리 용량(mAh)        │
    │                      ─────────────────       │
    │                      소비 전류(mA)            │
    │                                             │
    │   예: 2600mAh ÷ 100mA = 26시간              │
    │                                             │
    └─────────────────────────────────────────────┘
```

### 7.2 단순 계산 예제

**예제: ESP32 + SHT30 센서 (항상 Active)**

```
    배터리: 18650 (2600 mAh, 3.7V)
    소비 전류: 50 mA (Wi-Fi 끄고 센서만 사용)

    수명 = 2600 mAh ÷ 50 mA = 52시간 = 약 2.2일
```

### 7.3 듀티 사이클(Duty Cycle)을 고려한 계산

실제 IoT 기기는 항상 활성 상태가 아닙니다.
**깨어서 데이터를 전송하고, 다시 잠드는 패턴**을 반복합니다.

```
    듀티 사이클 패턴:

    전류(mA)
    250 ┤    ┌─┐         ┌─┐         ┌─┐
        │    │ │         │ │         │ │  Active
    200 ┤    │ │         │ │         │ │  (5초)
        │    │ │         │ │         │ │
    150 ┤    │ │         │ │         │ │
        │    │ │         │ │         │ │
    100 ┤    │ │         │ │         │ │
        │    │ │         │ │         │ │
     50 ┤    │ │         │ │         │ │
        │    │ │         │ │         │ │
   0.01 ┤────┘ └─────────┘ └─────────┘ └─── Deep Sleep
        │     5초          5초          5초    (55초)
      0 ┼─────────────────────────────────▶
              60초 주기      60초 주기
```

#### 평균 전류 계산 공식

```
    ┌───────────────────────────────────────────────────────┐
    │                                                       │
    │  평균 전류 = (I_active × T_active + I_sleep × T_sleep)│
    │              ─────────────────────────────────────     │
    │                     T_active + T_sleep                │
    │                                                       │
    └───────────────────────────────────────────────────────┘
```

**예제: 60초 주기, 5초 Active, 55초 Deep Sleep**

```
    I_active = 240 mA (Wi-Fi TX)
    T_active = 5초
    I_sleep  = 0.01 mA (10 μA)
    T_sleep  = 55초

    평균 전류 = (240 × 5 + 0.01 × 55) ÷ (5 + 55)
             = (1200 + 0.55) ÷ 60
             = 1200.55 ÷ 60
             = 20.01 mA

    배터리 수명 = 2600 mAh ÷ 20.01 mA
               = 129.9 시간
               = 약 5.4일
```

### 7.4 더 긴 수명을 원한다면?

슬립 시간을 늘려봅시다.

| 주기 | Active | Sleep | 평균 전류 | 2600mAh 수명 |
|------|--------|-------|-----------|-------------|
| 1분 | 5초 | 55초 | 20.0 mA | 5.4일 |
| 5분 | 5초 | 295초 | 4.0 mA | 27일 |
| 10분 | 5초 | 595초 | 2.0 mA | 54일 |
| 30분 | 5초 | 1795초 | 0.67 mA | 162일 |
| 1시간 | 5초 | 3595초 | 0.34 mA | 319일 |

> **결론**: Deep Sleep을 활용하면 배터리 수명을 **극적으로** 연장할 수 있습니다!

### 7.5 현실적인 보정 계수

실제 배터리 수명은 이론값보다 짧습니다. 다음 요소를 고려하세요:

```
    실제 수명 ≈ 이론 수명 × 보정 계수

    보정 요소:
    ┌──────────────────────────────────┐
    │ 배터리 자가 방전: ×0.95          │
    │ 레귤레이터 효율:  ×0.85 (LDO)   │
    │                  ×0.92 (DC-DC)  │
    │ 온도 영향:       ×0.90 (저온)   │
    │ 배터리 노화:     ×0.80 (1년후)  │
    ├──────────────────────────────────┤
    │ 종합 보정 계수:  약 ×0.7         │
    │ (보수적 추정)                    │
    └──────────────────────────────────┘

    예: 이론 5.4일 × 0.7 = 실제 약 3.8일
```

---

## 8. 여유율 (마진) 적용

### 8.1 왜 여유율이 필요한가?

| 이유 | 설명 |
|------|------|
| 부품 편차 | 같은 부품이라도 개체마다 소비 전류가 약간 다름 |
| 온도 변화 | 고온에서는 전류 소비가 증가하는 경향 |
| 노화 | 부품이 오래되면 특성이 변할 수 있음 |
| 측정 오차 | 데이터시트 값이 정확하지 않을 수 있음 |
| 미래 확장 | 나중에 부품을 추가할 여지를 남겨둠 |
| 돌입 전류 | 전원 인가 순간 과도 전류 발생 |

### 8.2 권장 여유율

| 용도 | 권장 여유율 | 설명 |
|------|------------|------|
| 취미/프로토타입 | 20% | 최소한의 여유 |
| **일반 프로젝트** | **30%** | **가장 흔히 사용** |
| 산업용/신뢰성 중요 | 50% | 안전한 설계 |
| 의료/항공 | 100% 이상 | 극도로 보수적 |

### 8.3 여유율 적용 예제

```
    계산된 최대 부하: 335.6 mA

    여유율 20%: 335.6 × 1.2 = 402.7 mA  →  500 mA 어댑터
    여유율 30%: 335.6 × 1.3 = 436.3 mA  →  500 mA 어댑터
    여유율 50%: 335.6 × 1.5 = 503.4 mA  →  750 mA 또는 1A 어댑터

    ※ 어댑터는 표준 용량 중 선택:
       500mA, 1A, 1.5A, 2A, 3A, 5A ...
```

---

## 9. 전원 예산표 작성 템플릿

실제 프로젝트에서는 다음과 같은 **전원 예산표(Power Budget Table)**를 작성합니다.

### 9.1 템플릿

```
┌────────────────────────────────────────────────────────────────┐
│                    전원 예산표 (Power Budget)                    │
│                                                                │
│  프로젝트명: ___________________________________               │
│  작성일:     ___________________________________               │
│  전원 전압:  _____ V                                           │
├────────┬──────┬──────────┬──────────┬──────────┬──────────────┤
│ 부품명  │ 수량 │ 단위 전류 │ 합계 전류 │ 피크 전류 │ 비고         │
│        │     │  (mA)    │  (mA)    │  (mA)    │              │
├────────┼──────┼──────────┼──────────┼──────────┼──────────────┤
│        │     │          │          │          │              │
│        │     │          │          │          │              │
│        │     │          │          │          │              │
├────────┼──────┼──────────┼──────────┼──────────┼──────────────┤
│ 소계   │     │          │          │          │              │
│ 여유(30%)│    │          │          │          │              │
│ 합계   │     │          │          │          │              │
├────────┴──────┴──────────┴──────────┴──────────┴──────────────┤
│ 선정 전원: _______ V / _______ A                              │
│ 배터리 수명 (해당 시): _______ 시간                             │
└────────────────────────────────────────────────────────────────┘
```

### 9.2 작성 예시 (위의 프로젝트)

```
┌────────────────────────────────────────────────────────────────┐
│                    전원 예산표 (Power Budget)                    │
│                                                                │
│  프로젝트명: 스마트홈 온습도 모니터                                │
│  작성일:     2024-01-15                                        │
│  전원 전압:  5V (USB)                                          │
├────────┬──────┬──────────┬──────────┬──────────┬──────────────┤
│ 부품명  │ 수량 │ 단위 전류 │ 합계 전류 │ 피크 전류 │ 비고         │
│        │     │  (mA)    │  (mA)    │  (mA)    │              │
├────────┼──────┼──────────┼──────────┼──────────┼──────────────┤
│ ESP32  │  1  │  240     │  240     │  380     │ Wi-Fi TX     │
│ SHT30  │  1  │    0.6   │    0.6   │    1.5   │ I2C          │
│ OLED   │  1  │   20     │   20     │   25     │ SSD1306      │
│ 릴레이  │  1  │   75     │   75     │   80     │ 5V 1채널     │
├────────┼──────┼──────────┼──────────┼──────────┼──────────────┤
│ 소계   │     │          │  335.6   │  486.5   │              │
│여유(30%)│    │          │  100.7   │  145.9   │              │
│ 합계   │     │          │  436.3   │  632.4   │              │
├────────┴──────┴──────────┴──────────┴──────────┴──────────────┤
│ 선정 전원: 5V / 1A USB 어댑터                                   │
│ 배터리 수명 (해당 시): 2600mAh ÷ 436.3mA = 약 6시간           │
└────────────────────────────────────────────────────────────────┘
```

---

## 핵심 정리

```
┌─────────────────────────────────────────────────────────┐
│                     핵심 정리                            │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  1. 모든 부품의 소비 전류는 데이터시트에서 확인한다       │
│                                                         │
│  2. ESP32 소비 전류:                                    │
│     - Wi-Fi TX: ~240mA (피크 380mA)                     │
│     - Deep Sleep: ~10μA                                 │
│                                                         │
│  3. 총 전류 = 각 부품 전류의 단순 합산 (병렬 연결)       │
│                                                         │
│  4. 반드시 20~30%의 여유율(마진)을 적용한다              │
│                                                         │
│  5. 배터리 수명 = 배터리 용량(mAh) ÷ 평균 전류(mA)      │
│                                                         │
│  6. Deep Sleep 활용 시 배터리 수명 극적 연장 가능        │
│                                                         │
│  7. 이론값에 보정 계수(약 ×0.7)를 적용하면               │
│     실제에 가까운 값을 얻을 수 있다                      │
│                                                         │
│  8. 전원 예산표를 작성하는 습관을 들이자                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 연습 문제

### 문제 1: 기본 계산
ESP32 (Wi-Fi 사용, 240mA) + DHT22 (1.5mA) + LCD 1602 (40mA) 시스템의
30% 여유율을 적용한 필요 전원 용량은?

<details>
<summary>정답 보기</summary>

```
합계 = 240 + 1.5 + 40 = 281.5 mA
여유율 적용 = 281.5 × 1.3 = 366.0 mA
→ 500mA 이상의 어댑터 필요
```
</details>

### 문제 2: 배터리 수명
3400mAh 18650 배터리로 위 시스템을 구동하면 몇 시간 사용 가능한가?
(보정 계수 0.7 적용)

<details>
<summary>정답 보기</summary>

```
이론 수명 = 3400 ÷ 281.5 = 12.08 시간
실제 수명 = 12.08 × 0.7 = 8.46 시간 ≈ 약 8.5시간
```
</details>

### 문제 3: 듀티 사이클
위 시스템에서 Deep Sleep을 활용하여, 10분마다 10초간 깨어나서 데이터를 전송하면
평균 전류와 배터리 수명은? (3400mAh, 보정 계수 0.7 적용)

<details>
<summary>정답 보기</summary>

```
평균 전류 = (281.5 × 10 + 0.01 × 590) ÷ 600
         = (2815 + 5.9) ÷ 600
         = 4.70 mA

이론 수명 = 3400 ÷ 4.70 = 723.4 시간 = 30.1일
실제 수명 = 30.1 × 0.7 = 21.1일 ≈ 약 3주
```
</details>

---

> **다음 학습**: [02-voltage-levels.md](./02-voltage-levels.md) - 3.3V vs 5V 전압 레벨에 대해 알아봅시다.
