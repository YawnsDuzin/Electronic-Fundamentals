# Phase 4: 디지털 통신 프로토콜 (Digital Communication Protocols)

## 개요

이 단계에서는 ESP32 마이크로컨트롤러가 외부 센서, 디스플레이, 모듈 등과 **데이터를 주고받는 방법**을 학습합니다.
전자 부품들이 서로 "대화"하는 방식, 즉 **통신 프로토콜**의 원리와 실습을 다룹니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                    Phase 4 학습 로드맵                           │
│                                                                 │
│  ┌──────┐   ┌──────┐   ┌──────┐   ┌──────┐   ┌──────┐         │
│  │ GPIO │──▶│ ADC  │──▶│ PWM  │──▶│ I2C  │──▶│ SPI  │         │
│  │기초IO│   │아날로│   │펄스폭│   │직렬  │   │직렬  │         │
│  │      │   │그변환│   │변조  │   │통신  │   │통신  │         │
│  └──────┘   └──────┘   └──────┘   └──────┘   └──────┘         │
│                                       │           │             │
│                                       ▼           ▼             │
│                                   ┌──────┐   ┌────────┐        │
│                                   │ UART │   │1-Wire  │        │
│                                   │시리얼│   │단선통신│        │
│                                   └──────┘   └────────┘        │
└─────────────────────────────────────────────────────────────────┘
```

---

## 통신 프로토콜 비교표

| 특성 | GPIO | ADC | PWM | I2C | SPI | UART | 1-Wire |
|------|------|-----|-----|-----|-----|------|--------|
| **신호 방향** | 입/출력 | 입력 | 출력 | 양방향 | 양방향 | 양방향 | 양방향 |
| **신호 유형** | 디지털 | 아날로그→디지털 | 디지털(의사 아날로그) | 디지털 | 디지털 | 디지털 | 디지털 |
| **필요 핀 수** | 1 | 1 | 1 | 2 (SDA, SCL) | 4+ (MOSI, MISO, SCK, CS) | 2 (TX, RX) | 1 (DQ) |
| **속도** | - | - | - | 100kHz~3.4MHz | 최대 80MHz | 9600~921600 bps | ~16kbps |
| **장치 수** | 핀당 1개 | 핀당 1개 | 핀당 1개 | 버스당 최대 127개 | CS 핀 수만큼 | 1:1 | 핀당 다수 |
| **거리** | 짧음 | 짧음 | 짧음 | ~1m | ~0.1m | ~15m (RS485: ~1200m) | ~100m |
| **풀업 저항** | 내장 가능 | 불필요 | 불필요 | **필수 (4.7kΩ)** | 불필요 | 불필요 | **필수 (4.7kΩ)** |
| **대표 장치** | LED, 버튼 | 가변저항, 가스센서 | 서보, LED 조광 | OLED, SHT30 | SD카드, TFT | GPS, 블루투스 | DS18B20 |

---

## 소프트웨어 개발자를 위한 비유

| 프로토콜 | 소프트웨어 비유 |
|---------|---------------|
| **GPIO** | Boolean 변수 - `true`(HIGH) 또는 `false`(LOW) 두 가지 상태만 존재 |
| **ADC** | `parseInt()` - 연속적인 아날로그 값을 이산적인 디지털 숫자로 변환 |
| **PWM** | `opacity` CSS 속성 - 0%~100% 사이의 값으로 밝기/세기 조절 |
| **I2C** | HTTP API - 주소(URL)로 장치를 찾고 데이터를 요청/전송 |
| **SPI** | 전이중 TCP 소켓 - 동시 양방향 고속 통신, 각 클라이언트마다 전용 연결(CS) |
| **UART** | WebSocket - 양쪽이 독립적으로 데이터를 보낼 수 있는 점대점 연결 |
| **1-Wire** | 공유 버스 네트워크 - 하나의 회선에 고유 MAC 주소를 가진 여러 장치 연결 |

---

## 목차

### 문서 (Documentation)

| 번호 | 주제 | 파일 | 난이도 |
|------|------|------|--------|
| 01 | GPIO (범용 입출력) | [01-gpio.md](./01-gpio.md) | 입문 |
| 02 | ADC (아날로그-디지털 변환) | [02-adc.md](./02-adc.md) | 입문 |
| 03 | PWM (펄스 폭 변조) | [03-pwm.md](./03-pwm.md) | 초급 |
| 04 | I2C (직렬 통신) | [04-i2c.md](./04-i2c.md) | 중급 |
| 05 | SPI (직렬 주변장치 인터페이스) | [05-spi.md](./05-spi.md) | 중급 |
| 06 | UART/Serial (범용 비동기 송수신) | [06-uart.md](./06-uart.md) | 초급 |
| 07 | 1-Wire (단선 통신) | [07-onewire.md](./07-onewire.md) | 초급 |

### 코드 예제 (Code Examples)

| 번호 | 파일 | 설명 |
|------|------|------|
| 01 | [gpio_led_button.ino](./code/gpio_led_button.ino) | LED 제어 + 버튼 토글 (디바운싱 포함) |
| 02 | [adc_read.ino](./code/adc_read.ino) | 아날로그 값 읽기 + 전압 변환 |
| 03 | [pwm_led.ino](./code/pwm_led.ino) | LED 밝기 페이드 인/아웃 (LEDC) |
| 04 | [i2c_scanner.ino](./code/i2c_scanner.ino) | I2C 버스 장치 스캐너 |
| 05 | [spi_sd_card.ino](./code/spi_sd_card.ino) | SD 카드 읽기/쓰기 |
| 06 | [uart_communication.ino](./code/uart_communication.ino) | UART2 외부 장치 통신 |
| 07 | [onewire_ds18b20.ino](./code/onewire_ds18b20.ino) | DS18B20 온도센서 읽기 |

---

## 선수 지식

- Phase 1~3의 기본 전자회로 개념 (전압, 전류, 저항)
- Arduino IDE 설치 및 ESP32 보드 설정 완료
- C/C++ 기본 문법 이해

## 필요 부품

| 부품 | 수량 | 용도 |
|------|------|------|
| ESP32 개발보드 | 1 | 메인 마이크로컨트롤러 |
| LED (빨강) | 2 | GPIO/PWM 실습 |
| 220Ω 저항 | 2 | LED 전류 제한 |
| 택트 스위치 (버튼) | 2 | GPIO 입력 실습 |
| 10kΩ 저항 | 2 | 풀업/풀다운 저항 |
| 가변저항 (10kΩ) | 1 | ADC 실습 |
| 4.7kΩ 저항 | 2 | I2C/1-Wire 풀업 |
| SSD1306 OLED (128x64) | 1 | I2C 디스플레이 실습 |
| MicroSD 카드 모듈 | 1 | SPI 실습 |
| DS18B20 온도센서 | 1 | 1-Wire 실습 |
| 점퍼 와이어 | 다수 | 배선 |
| 브레드보드 | 1 | 회로 구성 |

---

## 학습 팁

1. **순서대로 학습**: GPIO → ADC → PWM → I2C → SPI → UART → 1-Wire 순서로 진행하세요.
2. **코드를 직접 입력**: 복사-붙여넣기보다 직접 타이핑하면 이해가 빠릅니다.
3. **시리얼 모니터 활용**: `Serial.println()`으로 값을 확인하는 습관을 들이세요.
4. **회로도 먼저 확인**: 코드 업로드 전에 배선이 올바른지 반드시 확인하세요.
5. **오류를 두려워하지 마세요**: 배선 실수와 코드 오류는 학습의 일부입니다.

---

## 다음 단계

Phase 4를 완료하면 다음을 할 수 있습니다:
- 다양한 센서에서 데이터를 수집
- 디스플레이에 정보를 표시
- SD 카드에 데이터를 기록
- 외부 모듈과 시리얼 통신
- IoT 프로젝트의 하드웨어 인터페이스 구축
